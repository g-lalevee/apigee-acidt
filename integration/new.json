{
  "description": "BigQuery Filters",
  "updateTime": "2022-03-18T12:38:53.879Z",
  "createTime": "2022-03-02T08:43:38.251Z",
  "lastModifierEmail": "lalevee@google.com",
  "triggerConfigs": [
    {
      "label": "API Trigger",
      "startTasks": [
        {
          "taskId": "1"
        }
      ],
      "properties": {
        "Trigger name": "airportBQ_API_1"
      },
      "triggerType": "API",
      "triggerNumber": "1",
      "triggerId": "api_trigger/airportBQ_API_1"
    }
  ],
  "taskConfigs": [
    {
      "task": "GenericConnectorTask",
      "taskId": "3",
      "parameters": {
        "listEntitiesSortByColumns": {
          "key": "listEntitiesSortByColumns",
          "value": {
            "stringValue": "$`Task_3_listEntitiesSortByColumns`$"
          }
        },
        "filterClause": {
          "key": "filterClause",
          "value": {
            "stringValue": "$`Task_3_filterClause`$"
          }
        },
        "listEntitiesPageToken": {
          "key": "listEntitiesPageToken",
          "value": {
            "stringValue": "$`Task_3_listEntitiesPageToken`$"
          }
        },
        "entityType": {
          "key": "entityType",
          "value": {
            "stringValue": "airports"
          }
        },
        "listEntitiesPageSize": {
          "key": "listEntitiesPageSize",
          "value": {
            "stringValue": "$`Task_3_listEntitiesPageSize`$"
          }
        },
        "listEntitiesNextPageToken": {
          "key": "listEntitiesNextPageToken",
          "value": {
            "stringValue": "$`Task_3_listEntitiesNextPageToken`$"
          }
        },
        "config": {
          "key": "config",
          "value": {
            "jsonValue": "{\n  '@type': 'type.googleapis.com/enterprise.crm.eventbus.proto.connectors.GenericConnectorTaskConfig',\n  'connection': {\n    'connectionName': 'projects/bap-emea-apigee-5/locations/europe-west1/connections/airport-xtof',\n    'serviceName': 'projects/o05ef500f408f0d5dp-tp/locations/europe-west1/namespaces/connectors/services/istio-ingressgateway-connectors'\n  },\n  'operation': 'LIST_ENTITIES'\n}"
          }
        },
        "connectorOutputPayload": {
          "key": "connectorOutputPayload",
          "value": {
            "stringValue": "$`Task_3_connectorOutputPayload`$"
          }
        }
      },
      "nextTasks": [
        {
          "taskId": "4"
        }
      ],
      "taskExecutionStrategy": "WHEN_ALL_SUCCEED",
      "displayName": "Airport list with filter"
    },
    {
      "task": "EmailTask",
      "taskId": "4",
      "parameters": {
        "Cc": {
          "key": "Cc",
          "value": {
            "stringArray": {
              "stringValues": [
                "slebrun@google.com"
              ]
            }
          }
        },
        "TextBody": {
          "key": "TextBody",
          "value": {
            "stringValue": "$`Task_3_connectorOutputPayload`$"
          }
        },
        "Bcc": {
          "key": "Bcc",
          "value": {
            "stringArray": {}
          }
        },
        "AttachmentPath": {
          "key": "AttachmentPath",
          "value": {
            "stringArray": {}
          }
        },
        "To": {
          "key": "To",
          "value": {
            "stringArray": {
              "stringValues": [
                "lalevee@google.com"
              ]
            }
          }
        },
        "BodyFormat": {
          "key": "BodyFormat",
          "value": {
            "stringValue": "text"
          }
        },
        "EmailConfigInput": {
          "key": "EmailConfigInput",
          "value": {
            "jsonValue": "{\n  '@type': 'type.googleapis.com/enterprise.crm.eventbus.proto.EmailConfig'\n}"
          }
        },
        "Subject": {
          "key": "Subject",
          "value": {
            "stringValue": "Apigee Integration Airports"
          }
        }
      },
      "taskExecutionStrategy": "WHEN_ALL_SUCCEED",
      "displayName": "Send Email"
    },
    {
      "task": "FieldMappingTask",
      "taskId": "1",
      "parameters": {
        "FieldMappingConfigTaskParameterKey": {
          "key": "FieldMappingConfigTaskParameterKey",
          "value": {
            "jsonValue": "{\n  '@type': 'type.googleapis.com/enterprise.crm.eventbus.proto.FieldMappingConfig',\n  'mappedFields': [{\n    'inputField': {\n      'fieldType': 'STRING_VALUE',\n      'transformExpression': {\n        'initialValue': {\n          'literalValue': {\n            'stringValue': 'iso_country \\u003d \\u0027'\n          }\n        },\n        'transformationFunctions': [{\n          'functionType': {\n            'stringFunction': {\n              'functionName': 'CONCAT'\n            }\n          },\n          'parameters': [{\n            'initialValue': {\n              'referenceValue': '$countryCode$'\n            }\n          }]\n        }, {\n          'functionType': {\n            'stringFunction': {\n              'functionName': 'CONCAT'\n            }\n          },\n          'parameters': [{\n            'initialValue': {\n              'literalValue': {\n                'stringValue': '\\u0027'\n              }\n            }\n          }]\n        }]\n      }\n    },\n    'outputField': {\n      'referenceKey': '$`Task_3_filterClause`$',\n      'fieldType': 'STRING_VALUE',\n      'cardinality': 'OPTIONAL'\n    }\n  }]\n}"
          }
        }
      },
      "nextTasks": [
        {
          "taskId": "3"
        }
      ],
      "taskExecutionStrategy": "WHEN_ALL_SUCCEED",
      "displayName": "Set Filters"
    }
  ],
  "integrationParameters": [
    {
      "key": "`Task_3_listEntitiesPageSize`",
      "dataType": "INT_VALUE",
      "displayName": "`Task_3_listEntitiesPageSize`",
      "producer": "1_3"
    },
    {
      "key": "`Task_3_listEntitiesPageToken`",
      "dataType": "STRING_VALUE",
      "displayName": "`Task_3_listEntitiesPageToken`",
      "producer": "1_3"
    },
    {
      "key": "`Task_3_listEntitiesSortByColumns`",
      "dataType": "STRING_ARRAY",
      "displayName": "`Task_3_listEntitiesSortByColumns`",
      "producer": "1_3"
    },
    {
      "key": "`Task_3_filterClause`",
      "dataType": "STRING_VALUE",
      "displayName": "`Task_3_filterClause`",
      "producer": "1_3"
    },
    {
      "key": "`Task_3_listEntitiesNextPageToken`",
      "dataType": "STRING_VALUE",
      "defaultValue": {
        "stringValue": ""
      },
      "displayName": "`Task_3_listEntitiesNextPageToken`",
      "inputOutputType": "OUT",
      "isTransient": true,
      "producer": "1_3"
    },
    {
      "key": "`Task_3_connectorOutputPayload`",
      "dataType": "JSON_VALUE",
      "displayName": "`Task_3_connectorOutputPayload`",
      "inputOutputType": "OUT",
      "isTransient": true,
      "producer": "1_3",
      "jsonSchema": "{\n  \"type\": \"array\",\n  \"items\": {\n    \"type\": \"object\",\n    \"properties\": {\n      \"id\": {\n        \"type\": [\"number\", \"null\"],\n        \"readOnly\": false\n      },\n      \"ident\": {\n        \"type\": [\"string\", \"null\"],\n        \"readOnly\": false\n      },\n      \"type\": {\n        \"type\": [\"string\", \"null\"],\n        \"readOnly\": false\n      },\n      \"name\": {\n        \"type\": [\"string\", \"null\"],\n        \"readOnly\": false\n      },\n      \"latitude_deg\": {\n        \"type\": [\"number\", \"null\"],\n        \"readOnly\": false\n      },\n      \"longitude_deg\": {\n        \"type\": [\"number\", \"null\"],\n        \"readOnly\": false\n      },\n      \"elevation_ft\": {\n        \"type\": [\"number\", \"null\"],\n        \"readOnly\": false\n      },\n      \"continent\": {\n        \"type\": [\"string\", \"null\"],\n        \"readOnly\": false\n      },\n      \"iso_country\": {\n        \"type\": [\"string\", \"null\"],\n        \"readOnly\": false\n      },\n      \"iso_region\": {\n        \"type\": [\"string\", \"null\"],\n        \"readOnly\": false\n      },\n      \"municipality\": {\n        \"type\": [\"string\", \"null\"],\n        \"readOnly\": false\n      },\n      \"scheduled_service\": {\n        \"type\": [\"boolean\", \"null\"],\n        \"readOnly\": false\n      },\n      \"gps_code\": {\n        \"type\": [\"string\", \"null\"],\n        \"readOnly\": false\n      },\n      \"iata_code\": {\n        \"type\": [\"string\", \"null\"],\n        \"readOnly\": false\n      },\n      \"local_code\": {\n        \"type\": [\"string\", \"null\"],\n        \"readOnly\": false\n      },\n      \"home_link\": {\n        \"type\": [\"string\", \"null\"],\n        \"readOnly\": false\n      },\n      \"wikipedia_link\": {\n        \"type\": [\"string\", \"null\"],\n        \"readOnly\": false\n      },\n      \"keywords\": {\n        \"type\": [\"string\", \"null\"],\n        \"readOnly\": false\n      }\n    }\n  }\n}"
    },
    {
      "key": "countryCode",
      "dataType": "STRING_VALUE",
      "displayName": "countryCode",
      "inputOutputType": "IN"
    }
  ]
}
